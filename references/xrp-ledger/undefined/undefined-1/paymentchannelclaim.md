# PaymentChannelClaim

_페이찬 수정안에 의해 추가되었습니다._

결제 채널에서 XRP를 청구하거나, 결제 채널의 만료일을 조정하거나, 둘 다 조정할 수 있습니다. 이 트랜잭션은 지정된 채널에서 트랜잭션 발신자의 역할에 따라 다르게 사용할 수 있습니다:

채널의 소스 주소는 다음과 같습니다:

* 서명된 클레임이 있든 없든 채널에서 대상에게 XRP를 전송합니다.
* 채널의 설정 지연 시간이 지나자마자 채널이 만료되도록 설정합니다.
* 보류 중인 만료 시간을 지웁니다.
* 먼저 클레임을 처리하든 처리하지 않든 채널을 즉시 닫습니다. 채널에 XRP가 남아 있는 경우 소스 주소는 채널을 즉시 닫을 수 없습니다.

채널의 대상 주소는 가능합니다:

* 서명된 클레임을 사용하여 채널에서 XRP를 받습니다.
* 클레임을 처리한 후 즉시 채널을 닫아 채널의 출처에 미청구 XRP를 환불합니다.

이 트랜잭션을 전송하는 모든 주소가 가능합니다:

* 만료 또는 취소 후 시간이 이전 ledger의 마감 시간보다 오래된 경우 채널을 닫게 합니다. 유효하게 형성된 모든 결제 채널 클레임 트랜잭션은 트랜잭션의 내용에 관계없이 이 효과를 갖습니다.

## PaymentChannelClaim JSON 예시

```
{
  "Channel": "C1AE6DDDEEC05CF2978C0BAD6FE302948E9533691DC749DCDD3B9E5992CA6198",
  "Balance": "1000000",
  "Amount": "1000000",
  "Signature": "30440220718D264EF05CAED7C781FF6DE298DCAC68D002562C9BF3A07C1E721B420C0DAB02203A5A4779EF4D2CCC7BC3EF886676D803A9981B928D3B8ACA483B80ECA3CD7B9B",
  "PublicKey": "32D2471DB72B27E3310F355BB33E339BF26F8392D5A93D3BC0FC3B566612DA0F0A"
}
```

## PaymentChannelClaim 필드

일반적인 필드 외에도 PaymentChannelClaim 트랜잭션은 다음 필드를 사용합니다:

| 필드        | JSON 유형 | [내부 유형](https://xrpl.org/serialization.html) | 설명                                                                                                                                                                                 |
| --------- | ------- | -------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Channel   | 문자열     | 해시256                                        | 채널의 고유 ID(64자 16진수 문자열)입니다.                                                                                                                                                        |
| Balance   | 문자열     | 양                                            | (선택 사항) 이 클레임을 처리한 후 이 채널에서 전달한 XRP의 총 금액(드롭 단위)입니다. XRP를 전달하는 데 필요합니다. 지금까지 채널에서 전달한 총 금액보다 많아야 하지만 서명된 클레임의 금액보다 크면 안 됩니다. 채널을 닫을 때를 제외하고 반드시 제공해야 합니다.                          |
| Amount    | 문자열     | 양                                            | (선택 사항) 서명에 의해 승인된 XRP의 금액(드롭 단위)입니다. 이 금액은 서명된 메시지의 금액과 일치해야 합니다. 이전에 상환한 XRP를 포함하여 채널에서 분배할 수 있는 누적 XRP 금액입니다.                                                                   |
| Signature | 문자열     | blob                                         | (선택 사항) 16진수인 이 클레임의 서명입니다. 서명된 메시지에는 채널 ID와 청구 금액이 포함됩니다. 트랜잭션 발신자가 채널의 소스 주소가 아닌 경우 필수입니다.                                                                                       |
| PublicKey | 문자열     | blob                                         | (선택 사항) 서명에 사용된 공개 키(16진수)입니다. 채널의 원장에 저장된 공개키와 일치해야 합니다. 트랜잭션 발신자가 채널의 소스 주소이고 서명 필드를 생략하지 않는 한 필수입니다. (트랜잭션에는 공개키가 포함되어 있으므로 Ripple이 트랜잭션을 ledger에 적용하기 전에 서명의 유효성을 확인할 수 있습니다.) |

결제 채널이 수정된 수정안(2020-05-01)이 활성화되기 전에 생성된 경우, 결제 채널의 목적지가 삭제되어 현재 ledger에 존재하지 않을 수 있습니다. 목적지가 삭제된 경우, 소스 계정은 채널에서 목적지로 XRP를 전송할 수 없으며, 대신 트랜잭션은 tecNO\_DST로 실패합니다. (물론 삭제된 계정은 트랜잭션을 전혀 전송할 수 없습니다.) 대상 계정이 삭제된 경우 채널 만료 조정, XRP가 없는 채널 폐쇄, 만료 시간이 지난 채널 제거 등 이 트랜잭션 유형의 다른 사용에는 영향을 받지 않습니다.

## 결제 채널 클레임 플래그

결제 채널 클레임 유형의 트랜잭션은 다음과 같이 플래그 필드에 추가 값을 지원합니다:

| 플래그 이름  | 16진수 값     | 소수점 값  | 설명                                                                                                                                                                                                                                                                                                                                                                                           |
| ------- | ---------- | ------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| tfRenew | 0x00010000 | 65536  | 채널의 만료 시간을 지웁니다. (만료는 채널의 불변 취소 후 시간과 다릅니다.) 결제 채널의 소스 주소만 이 플래그를 사용할 수 있습니다.                                                                                                                                                                                                                                                                                                                |
| tfClose | 0x00020000 | 131072 | 채널 폐쇄를 요청합니다. 채널 소스 주소와 대상 주소만 이 플래그를 사용할 수 있습니다. 이 플래그는 현재 청구를 처리한 후 채널에 더 이상 할당된 XRP가 없거나 대상 주소가 이 플래그를 사용하는 경우 채널을 즉시 닫습니다. 소스 주소가 채널이 여전히 XRP를 보유하고 있을 때 이 플래그를 사용하는 경우, 설정 지연 시간이 경과한 후 채널이 닫히도록 예약합니다. (구체적으로, 채널에 이미 이전 만료 시간이 있는 경우를 제외하고 채널의 만료 시간을 이전 원장의 마감 시간에 채널의 SettleDelay 시간을 더한 시간으로 설정합니다.) 채널이 여전히 XRP를 보유하고 있을 때 대상 주소가 이 플래그를 사용하면, 청구를 처리한 후 남은 XRP는 모두 소스 주소로 반환됩니다. |
